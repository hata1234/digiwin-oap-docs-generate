# ERP æ–‡æª”è‡ªå‹•ç”Ÿæˆå·¥å…·

[![Version](https://img.shields.io/badge/version-2.0.0-blue.svg)](https://github.com/hata1234/digiwin-oap-docs-generate)
[![Node](https://img.shields.io/badge/node-%3E%3D%2016.0.0-green.svg)](https://nodejs.org)
[![TypeScript](https://img.shields.io/badge/typescript-5.3.3-blue.svg)](https://www.typescriptlang.org/)
[![License](https://img.shields.io/badge/license-ISC-green.svg)](LICENSE)

## ğŸ“‹ ç›®éŒ„

- [æ¦‚è¿°](#æ¦‚è¿°)
- [æ ¸å¿ƒç‰¹é»](#æ ¸å¿ƒç‰¹é»)
- [å¿«é€Ÿé–‹å§‹](#å¿«é€Ÿé–‹å§‹)
- [ç’°å¢ƒè¨­ç½®](#ç’°å¢ƒè¨­ç½®)
- [åŠŸèƒ½è©³è§£](#åŠŸèƒ½è©³è§£)
  - [è³‡æ–™åº«æ¢ç´¢](#è³‡æ–™åº«æ¢ç´¢)
  - [æ–‡æª”ç”Ÿæˆ](#æ–‡æª”ç”Ÿæˆ)
  - [æ‰¹æ¬¡è™•ç†](#æ‰¹æ¬¡è™•ç†)
  - [Excel æ•´åˆ](#excel-æ•´åˆ)
- [å‘½ä»¤åƒè€ƒ](#å‘½ä»¤åƒè€ƒ)
- [æŠ€è¡“æ¶æ§‹](#æŠ€è¡“æ¶æ§‹)
- [å·¥ä½œæµç¨‹ç¯„ä¾‹](#å·¥ä½œæµç¨‹ç¯„ä¾‹)
- [æ•…éšœæ’é™¤](#æ•…éšœæ’é™¤)
- [ç‰ˆæœ¬æ­·å²](#ç‰ˆæœ¬æ­·å²)
- [è²¢ç»æŒ‡å—](#è²¢ç»æŒ‡å—)

## æ¦‚è¿°

æœ¬å°ˆæ¡ˆç”±AIç”Ÿæˆï¼Œæ—¨åœ¨é€éé¼æ–°è³‡æ–™åº«çš„OAPMBè¡¨ä»¥åŠé¡§å•é¡Œä¾›ä¹‹çš„Excelæ–‡æª”ï¼Œè‡ªå‹•ç”ŸæˆERP APIæ¬„ä½æ–‡æª”ã€‚ç”¢ç”Ÿçš„APIæ–‡æª”æ–¹ä¾¿èªè¨€æ¨¡å‹å¿«é€Ÿç†è§£APIçš„å„é …è¦å‰‡ï¼Œä¸¦ä¸”èƒ½å¤ å¿«é€Ÿç”ŸæˆAPIæ–‡æª”ã€‚

### ğŸŒŸ ä¸»è¦åŠŸèƒ½
ERP æ–‡æª”è‡ªå‹•ç”Ÿæˆå·¥å…·æ˜¯ä¸€å€‹å®Œå…¨ç¨ç«‹çš„ TypeScript CLI å·¥å…·ï¼Œå°ˆé–€ç”¨æ–¼è‡ªå‹•ç”Ÿæˆ ERP API æ¬„ä½æ–‡æª”ã€‚æ­¤å·¥å…·ç›´æ¥é€£æ¥ SQL Server è³‡æ–™åº«ï¼ŒåŸºæ–¼ OAPMB è¡¨çš„å¯¦éš›æŸ¥è©¢çµæœç”Ÿæˆæ–‡æª”ï¼Œç¢ºä¿æ‰€æœ‰è³‡æ–™çš„çœŸå¯¦æ€§å’Œæº–ç¢ºæ€§ã€‚

###  ğŸš€æ³¨æ„äº‹é …
æœ¬æ–‡ä»¶ä¸åŒ…å«ç”Ÿæˆèªè­‰è¦å‰‡åŠé€£æ¥æ–¹å¼èªªæ˜ï¼Œç›®çš„åªæ˜¯è®“ç…©é›œçš„excelæ–‡ä»¶ç°¡åŒ–ï¼Œè®“èªè¨€æ¨¡å‹è®€å–æ™‚ç¯€çœTokenè€Œå·²ï¼Œå¦‚æœ‰vkeyåŠvsignåŠ å¯†è¦å‰‡æˆ–æ˜¯APIé€£ç·šå•é¡Œï¼Œè«‹èˆ‡æ‚¨çš„é¡§å•è¯ç³»ã€‚

### ğŸ¯ è¨­è¨ˆç†å¿µ

- **é˜²æ­¢ AI å¹»è¦º**ï¼šæ‰€æœ‰è³‡æ–™ç›´æ¥ä¾†è‡ªè³‡æ–™åº«æŸ¥è©¢ï¼Œçµ•ä¸ä½¿ç”¨ç¡¬ç·¨ç¢¼æˆ–å‡è¨­çš„è³‡æ–™
- **å®Œå…¨ç¨ç«‹**ï¼šä¸ä¾è³´ä¸»å°ˆæ¡ˆçš„ä»»ä½•çµ„ä»¶ï¼Œå¯å–®ç¨éƒ¨ç½²å’Œä½¿ç”¨
- **æ‰¹æ¬¡è™•ç†**ï¼šæ”¯æ´ 101 å€‹æ“ä½œä»£ç¢¼çš„è‡ªå‹•åŒ–è™•ç†ï¼Œå¤§å¹…æå‡æ•ˆç‡
- **æ™ºèƒ½åˆä½µ**ï¼šè‡ªå‹•åˆ†æä¸¦åˆä½µ Excel æ–‡æª”ï¼Œæ¸›å°‘äººå·¥ä½œæ¥­

## æ ¸å¿ƒç‰¹é»

### âœ… åŸºç¤åŠŸèƒ½
- ç›´æ¥é€£æ¥ SQL Serverï¼Œä½¿ç”¨æ¨™æº– `mssql` å¥—ä»¶
- å®Œæ•´çš„è³‡æ–™åº«æ¢ç´¢åŠŸèƒ½ï¼Œäº†è§£è³‡æ–™çµæ§‹
- å¤šæ ¼å¼æ–‡æª”ç”Ÿæˆï¼ˆREADMEã€JSONã€Markdownã€TypeScript ä»‹é¢ï¼‰
- æ”¯æ´æ‰¹æ¬¡è™•ç†å’Œä¸¦è¡ŒåŸ·è¡Œ

### ğŸ†• é€²éšåŠŸèƒ½
- **Excel æ–‡æª”æ™ºèƒ½åˆä½µ**ï¼šè‡ªå‹•åˆ†æå·®ç•°ä¸¦åˆä½µ
- **æ‰¹æ¬¡åˆ†æåˆä½µ**ï¼šä¸€æ¬¡è™•ç†æ‰€æœ‰ 101 å€‹æ“ä½œä»£ç¢¼
- **æ–¹æ³•ç‰¹å®šæ–‡æª”**ï¼šè‡ªå‹•ç”Ÿæˆ create.mdã€query.mdã€update.md ç­‰
- **æœªçŸ¥æ¬„ä½è™•ç†**ï¼šå®Œæ•´è¨˜éŒ„ MB003-MB033 æ¬„ä½çš„å€¼å°ç…§
- **è¡çªåˆ†æå ±å‘Š**ï¼šæ™ºèƒ½è©•ä¼°é¢¨éšªç­‰ç´šï¼Œæä¾›è™•ç†å»ºè­°

### ğŸ“Š çµ±è¨ˆæ•¸æ“š
- **æ“ä½œä»£ç¢¼ç¸½æ•¸**ï¼š101 å€‹
- **æ¯å€‹æ“ä½œç”Ÿæˆæª”æ¡ˆ**ï¼š10 å€‹ï¼ˆåŒ…å« unknown-field-values.mdï¼‰
- **å¹³å‡ç”Ÿæˆæ™‚é–“**ï¼šç´„ 2 ç§’/æ“ä½œ
- **æ‰¹æ¬¡è™•ç†ç¸½æ™‚é–“**ï¼šç´„ 3-4 åˆ†é˜
- **è‡ªå‹•åˆä½µæˆåŠŸç‡**ï¼šç´„ 60-70%

## å¿«é€Ÿé–‹å§‹

### 1. å…‹éš†æˆ–è¤‡è£½å·¥å…·

```bash
# å¦‚æœæ˜¯ç¨ç«‹ repository
git clone https://github.com/hata1234/digiwin-oap-docs-generate.git
cd digiwin-oap-docs-generate

# å¦‚æœå¾ç¾æœ‰å°ˆæ¡ˆè¤‡è£½
cp -r /opt/apiserv/tools/digiwin-oap-docs-generate /your/new/location
cd /your/new/location/digiwin-oap-docs-generate
```

### 2. å®‰è£ä¾è³´

```bash
npm install
```

### 3. é…ç½®ç’°å¢ƒ

```bash
# è¤‡è£½ç’°å¢ƒè®Šæ•¸ç¯„ä¾‹
cp .env.example .env

# ç·¨è¼¯é…ç½®æª”æ¡ˆ
nano .env
```

### 4. æ¸¬è©¦é€£æ¥

```bash
npm run dev test
```

### 5. ç”Ÿæˆç¬¬ä¸€å€‹æ–‡æª”

```bash
npm run generate -- --operation ACPI02
```

## ç’°å¢ƒè¨­ç½®

### å¿…è¦çš„ç’°å¢ƒè®Šæ•¸

å‰µå»º `.env` æª”æ¡ˆä¸¦é…ç½®ä»¥ä¸‹è®Šæ•¸ï¼š

```env
# SQL Server é€£æ¥è¨­å®š
DB_SERVER=your_server_address
DB_PORT=1433
DB_DATABASE=your_database_name
DB_USERNAME=your_username
DB_PASSWORD=your_password

# é€£æ¥é¸é …
DB_ENCRYPT=false
DB_TRUST_SERVER_CERTIFICATE=true

# æŸ¥è©¢å’Œè¼¸å‡ºè¨­å®š
DEFAULT_BATCH_SIZE=50
MAX_BATCH_SIZE=500
DEFAULT_OUTPUT_DIR=./output

# Excel æª”æ¡ˆè·¯å¾‘ï¼ˆå¦‚æœä½¿ç”¨ Excel æ•´åˆåŠŸèƒ½ï¼‰
EXCEL_SOURCE_DIR=/path/to/GP40
```

### ç³»çµ±éœ€æ±‚

- Node.js >= 16.0.0
- npm >= 7.0.0
- SQL Server 2016 æˆ–æ›´é«˜ç‰ˆæœ¬
- è‡³å°‘ 1GB å¯ç”¨è¨˜æ†¶é«”
- ç´„ 100MB ç£ç¢Ÿç©ºé–“ï¼ˆç”¨æ–¼è¼¸å‡ºæª”æ¡ˆï¼‰

## åŠŸèƒ½è©³è§£

### è³‡æ–™åº«æ¢ç´¢

æ¢ç´¢åŠŸèƒ½è®“æ‚¨åœ¨ç”Ÿæˆæ–‡æª”å‰äº†è§£è³‡æ–™çµæ§‹ï¼š

#### 1. æ¸¬è©¦è³‡æ–™åº«é€£æ¥
```bash
npm run dev test
```
ç¢ºèªè³‡æ–™åº«é€£æ¥æ­£å¸¸ï¼Œé¡¯ç¤ºé€£æ¥è³‡è¨Šã€‚

#### 2. æŸ¥çœ‹ OAPMB è¡¨çµæ§‹
```bash
npm run explore table
```
é¡¯ç¤ºå®Œæ•´çš„è¡¨çµæ§‹ï¼ŒåŒ…å«æ‰€æœ‰æ¬„ä½åç¨±ã€è³‡æ–™å‹åˆ¥ã€å…è¨± NULL ç­‰è³‡è¨Šã€‚

#### 3. åˆ—å‡ºæ‰€æœ‰æ“ä½œä»£ç¢¼
```bash
npm run explore operations
```
è¼¸å‡ºç¯„ä¾‹ï¼š
```
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•¦â•â•â•â•â•â•â•â•â•—
â•‘ æ“ä½œä»£ç¢¼   â•‘ è¨˜éŒ„æ•¸ â•‘
â• â•â•â•â•â•â•â•â•â•â•â•â•â•¬â•â•â•â•â•â•â•â•â•£
â•‘ ACPI02     â•‘ 256    â•‘
â•‘ ACPI03     â•‘ 189    â•‘
â•‘ INVI01     â•‘ 342    â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•©â•â•â•â•â•â•â•â•â•
å…± 101 å€‹æ“ä½œä»£ç¢¼
```

#### 4. åˆ†æ MB æ¬„ä½ä½¿ç”¨æƒ…æ³
```bash
npm run explore mb-fields
```
é¡¯ç¤º MB001-MB033 æ¬„ä½çš„ä½¿ç”¨çµ±è¨ˆï¼Œå¹«åŠ©äº†è§£å“ªäº›æ¬„ä½åŒ…å«è³‡æ–™ã€‚

#### 5. æŸ¥çœ‹ç‰¹å®šæ“ä½œçš„ç¯„ä¾‹è³‡æ–™
```bash
npm run explore operation ACPI02
npm run explore operation ACPI02 --limit 10
```
é¡¯ç¤ºæŒ‡å®šæ“ä½œä»£ç¢¼çš„å¯¦éš›è³‡æ–™ç¯„ä¾‹ã€‚

### æ–‡æª”ç”Ÿæˆ

ç”ŸæˆåŠŸèƒ½å°‡è³‡æ–™åº«è³‡æ–™è½‰æ›ç‚ºçµæ§‹åŒ–æ–‡æª”ï¼š

#### åŸºæœ¬ç”Ÿæˆå‘½ä»¤
```bash
# ç”ŸæˆåŸºæœ¬æ–‡æª”ï¼ˆREADME + JSONï¼‰
npm run generate -- --operation ACPI02

# ç”Ÿæˆæ‰€æœ‰æ ¼å¼æ–‡æª”
npm run generate -- --operation ACPI02 --format all

# æŒ‡å®šç‰¹å®šæ ¼å¼
npm run generate -- --operation ACPI02 --format readme,json,field-mapping

# è‡ªè¨‚è¼¸å‡ºç›®éŒ„
npm run generate -- --operation ACPI02 --output ./my-docs

# é¡¯ç¤ºè©³ç´°è¼¸å‡º
npm run generate -- --operation ACPI02 --verbose
```

#### ç”Ÿæˆçš„æ–‡æª”é¡å‹

1. **README.md**
   - å®Œæ•´çš„æ¬„ä½èªªæ˜æ–‡æª”
   - æŒ‰è³‡æ–™è¡¨åˆ†çµ„çš„æ¬„ä½åˆ—è¡¨
   - å¿…å¡«æ¬„ä½æ¸…å–®å’Œè³‡æ–™æ ¼å¼è¦ç¯„
   - API å‘¼å«ç¯„ä¾‹

2. **field-data.json**
   - çµæ§‹åŒ–çš„æ¬„ä½è³‡æ–™
   - æ¬„ä½æ˜ å°„å’Œçµ±è¨ˆè³‡è¨Š
   - é©—è­‰è¦å‰‡å’Œ TypeScript ä»‹é¢åƒè€ƒ

3. **all-fields.md**
   - å®Œæ•´çš„æ¬„ä½è³‡æ–™è¡¨æ ¼
   - åŒ…å«æ‰€æœ‰æ¬„ä½çš„è©³ç´°è³‡è¨Š
   - é©åˆé–‹ç™¼è€…æŸ¥è©¢

4. **field-mapping.md**
   - API æ¬„ä½ â†” è³‡æ–™åº«æ¬„ä½å°ç…§è¡¨
   - TypeScript ä»‹é¢å®šç¾©
   - ç¨‹å¼é–‹ç™¼åƒè€ƒ

5. **quick-reference.md**
   - å¿«é€Ÿåƒè€ƒæŒ‡å—
   - å¿…å¡«æ¬„ä½ã€æ—¥æœŸæ¬„ä½ã€æ•¸å€¼æ¬„ä½åˆ†é¡
   - å¸¸è¦‹éŒ¯èª¤å’Œæ³¨æ„äº‹é …

6. **unknown-field-values.md**
   - MB003-MB033 æœªçŸ¥æ¬„ä½çš„å€¼å°ç…§è¡¨
   - å¹«åŠ©ç†è§£æ¬„ä½ç”¨é€”å’Œå¯èƒ½çš„å€¼

### æ‰¹æ¬¡è™•ç†

æ‰¹æ¬¡è™•ç†åŠŸèƒ½è®“æ‚¨ä¸€æ¬¡è™•ç†æ‰€æœ‰æ“ä½œä»£ç¢¼ï¼š

#### æ‰¹æ¬¡ç”Ÿæˆæ‰€æœ‰æ–‡æª”
```bash
# ç‚ºæ‰€æœ‰ 101 å€‹æ“ä½œä»£ç¢¼ç”Ÿæˆæ–‡æª”
npm run generate-all

# é è¦½æ¨¡å¼ï¼ˆä¸å¯¦éš›ç”Ÿæˆï¼‰
./scripts/generate-all.sh -d

# åªç”Ÿæˆç‰¹å®šæ“ä½œä»£ç¢¼
./scripts/generate-all.sh ACPI02 ACPI03

# é¡¯ç¤ºè©³ç´°è¼¸å‡º
./scripts/generate-all.sh -v

# æŒ‡å®šè¼¸å‡ºç›®éŒ„å’Œæ ¼å¼
./scripts/generate-all.sh -o ./my-docs -f readme,json
```

#### åˆ—å‡ºæ‰€æœ‰æ“ä½œä»£ç¢¼
```bash
# å¿«é€Ÿåˆ—å‡ºï¼ˆç°¡å–®æ ¼å¼ï¼‰
npm run list-operations

# è¡¨æ ¼æ ¼å¼
./scripts/list-operations.sh

# JSON æ ¼å¼
./scripts/list-operations.sh -f json

# CSV æ ¼å¼
./scripts/list-operations.sh -f csv

# éæ¿¾ç‰¹å®šæ¨¡å¼
./scripts/list-operations.sh -F '^ACP'

# æŒ‰è¨˜éŒ„æ•¸æ’åº
./scripts/list-operations.sh -s count
```

### Excel æ•´åˆ

Excel æ•´åˆåŠŸèƒ½è®“æ‚¨åˆä½µå®˜æ–¹ Excel æ–‡æª”çš„å…§å®¹ï¼š

#### æƒæ Excel æª”æ¡ˆ
```bash
# æŸ¥çœ‹æ‰€æœ‰å¯ç”¨çš„ Excel æª”æ¡ˆ
npm run import-excel scan
```

#### åˆ†æå–®ä¸€æ“ä½œ
```bash
# åˆ†æ Excel èˆ‡è³‡æ–™åº«æ–‡æª”çš„å·®ç•°
npm run import-excel analyze ACPI02

# é¡¯ç¤ºè©³ç´°è¡çªè³‡è¨Š
npm run import-excel analyze ACPI02 --detailed
```

#### åˆä½µå–®ä¸€æ“ä½œ
```bash
# åˆä½µ Excel å…§å®¹åˆ°ç¾æœ‰æ–‡æª”
npm run import-excel merge ACPI02

# å¼·åˆ¶åˆä½µï¼ˆå¿½ç•¥è¡çªï¼‰
npm run import-excel merge ACPI02 --force
```

#### æ‰¹æ¬¡åˆ†æåˆä½µ
```bash
# é è¦½æ¨¡å¼ - åˆ†ææ‰€æœ‰æ“ä½œä½†ä¸åŸ·è¡Œåˆä½µ
npm run analyze-merge-all -- -d

# åŸ·è¡Œæ‰¹æ¬¡åˆä½µ - è‡ªå‹•åˆä½µç„¡è¡çªé …ç›®
npm run analyze-merge-all

# åªè™•ç†æœ‰è¡çªçš„æ“ä½œ
npm run analyze-merge-all -- -c

# è¨­å®šä¸¦è¡Œä»»å‹™æ•¸ï¼ˆé è¨­ 4ï¼‰
npm run analyze-merge-all -- -j 8

# èª¿æ•´è‡ªå‹•åˆä½µé–¾å€¼ï¼ˆé è¨­ 0.8ï¼‰
npm run analyze-merge-all -- -t 0.9
```

#### è¡çªé¡å‹èªªæ˜

- **ğŸŸ¢ ä½é¢¨éšª**ï¼ˆé€šå¸¸å¯è‡ªå‹•åˆä½µï¼‰
  - èªªæ˜æ–‡å­—å·®ç•°
  - ç¯„ä¾‹å€¼æ›´æ–°
  - å‚™è¨»è³‡è¨Š

- **ğŸŸ¡ ä¸­é¢¨éšª**ï¼ˆå»ºè­°äººå·¥ç¢ºèªï¼‰
  - å¿…å¡«ç‹€æ…‹è®Šæ›´
  - é©—è­‰è¦å‰‡è®Šæ›´
  - é è¨­å€¼è®Šæ›´

- **ğŸ”´ é«˜é¢¨éšª**ï¼ˆå¿…é ˆäººå·¥è™•ç†ï¼‰
  - è³‡æ–™å‹æ…‹è¡çª
  - æ¬„ä½æ˜ å°„è¡çª
  - çµæ§‹æ€§è®Šæ›´

## å‘½ä»¤åƒè€ƒ

### ä¸»è¦å‘½ä»¤

| å‘½ä»¤ | èªªæ˜ | ç¯„ä¾‹ |
|------|------|------|
| `npm run dev test` | æ¸¬è©¦è³‡æ–™åº«é€£æ¥ | `npm run dev test` |
| `npm run explore` | æ¢ç´¢è³‡æ–™åº«çµæ§‹ | `npm run explore operations` |
| `npm run generate` | ç”Ÿæˆæ–‡æª” | `npm run generate -- --operation ACPI02` |
| `npm run generate-all` | æ‰¹æ¬¡ç”Ÿæˆæ‰€æœ‰æ–‡æª” | `npm run generate-all` |
| `npm run import-excel` | Excel æ–‡æª”æ“ä½œ | `npm run import-excel analyze ACPI02` |
| `npm run analyze-merge-all` | æ‰¹æ¬¡åˆ†æåˆä½µ | `npm run analyze-merge-all -- -d` |
| `npm run list-operations` | åˆ—å‡ºæ‰€æœ‰æ“ä½œä»£ç¢¼ | `npm run list-operations` |

### åƒæ•¸èªªæ˜

#### explore å‘½ä»¤åƒæ•¸
- `table` - é¡¯ç¤ºè¡¨çµæ§‹
- `operations` - åˆ—å‡ºæ“ä½œä»£ç¢¼
- `mb-fields` - åˆ†æ MB æ¬„ä½
- `operation <code>` - æŸ¥çœ‹ç‰¹å®šæ“ä½œ
  - `--limit <n>` - é™åˆ¶é¡¯ç¤ºç­†æ•¸

#### generate å‘½ä»¤åƒæ•¸
- `--operation <code>` - æ“ä½œä»£ç¢¼ï¼ˆå¿…å¡«ï¼‰
- `--output <path>` - è¼¸å‡ºç›®éŒ„
- `--format <types>` - æ–‡æª”æ ¼å¼
- `--verbose` - è©³ç´°è¼¸å‡º

#### import-excel å‘½ä»¤åƒæ•¸
- `scan` - æƒæ Excel æª”æ¡ˆ
- `analyze <code>` - åˆ†æå·®ç•°
  - `--detailed` - è©³ç´°åˆ†æ
- `merge <code>` - åˆä½µæ–‡æª”
  - `--force` - å¼·åˆ¶åˆä½µ

## æŠ€è¡“æ¶æ§‹

### æ ¸å¿ƒæŠ€è¡“å †ç–Š
- **èªè¨€**ï¼šTypeScript 5.3.3
- **åŸ·è¡Œç’°å¢ƒ**ï¼šNode.js >= 16.0.0
- **è³‡æ–™åº«**ï¼šSQL Server (ä½¿ç”¨ mssql å¥—ä»¶)
- **CLI æ¡†æ¶**ï¼šCommander.js
- **UI å¥—ä»¶**ï¼šchalk (å½©è‰²è¼¸å‡º)ã€ora (é€²åº¦æ¢)
- **Excel è™•ç†**ï¼šxlsx

### å°ˆæ¡ˆçµæ§‹
```
digiwin-oap-docs-generate/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ index.ts                    # CLI å…¥å£é»
â”‚   â”œâ”€â”€ config/
â”‚   â”‚   â””â”€â”€ database.ts            # è³‡æ–™åº«é…ç½®
â”‚   â”œâ”€â”€ services/
â”‚   â”‚   â”œâ”€â”€ database.service.ts    # è³‡æ–™åº«é€£æ¥æœå‹™
â”‚   â”‚   â”œâ”€â”€ explorer.service.ts    # è³‡æ–™æ¢ç´¢æœå‹™
â”‚   â”‚   â”œâ”€â”€ excel-import.service.ts # Excel åŒ¯å…¥æœå‹™
â”‚   â”‚   â”œâ”€â”€ merge.service.ts       # åˆä½µæœå‹™
â”‚   â”‚   â””â”€â”€ batch-merge-analyzer.service.ts # æ‰¹æ¬¡åˆ†ææœå‹™
â”‚   â”œâ”€â”€ generators/
â”‚   â”‚   â”œâ”€â”€ readme.generator.ts    # README ç”Ÿæˆå™¨
â”‚   â”‚   â”œâ”€â”€ json.generator.ts      # JSON ç”Ÿæˆå™¨
â”‚   â”‚   â”œâ”€â”€ markdown.generator.ts  # Markdown ç”Ÿæˆå™¨
â”‚   â”‚   â”œâ”€â”€ method-document.generator.ts # æ–¹æ³•æ–‡æª”ç”Ÿæˆå™¨
â”‚   â”‚   â”œâ”€â”€ excel-merge.generator.ts # Excel åˆä½µç”Ÿæˆå™¨
â”‚   â”‚   â””â”€â”€ conflict-report.generator.ts # è¡çªå ±å‘Šç”Ÿæˆå™¨
â”‚   â””â”€â”€ types/
â”‚       â””â”€â”€ index.ts              # TypeScript å‹åˆ¥å®šç¾©
â”œâ”€â”€ scripts/
â”‚   â”œâ”€â”€ generate-all.sh           # æ‰¹æ¬¡ç”Ÿæˆè…³æœ¬
â”‚   â”œâ”€â”€ list-operations.sh        # åˆ—å‡ºæ“ä½œè…³æœ¬
â”‚   â””â”€â”€ analyze-and-merge-all.sh  # æ‰¹æ¬¡åˆ†æåˆä½µè…³æœ¬
â”œâ”€â”€ docs/
â”‚   â””â”€â”€ BATCH-MERGE-GUIDE.md      # æ‰¹æ¬¡åˆä½µæŒ‡å—
â””â”€â”€ merge-reports/                # åˆä½µå ±å‘Šè¼¸å‡ºç›®éŒ„
```

### è¨­è¨ˆåŸå‰‡

1. **è³‡æ–™çœŸå¯¦æ€§**
   - æ‰€æœ‰è³‡æ–™ç›´æ¥ä¾†è‡ªè³‡æ–™åº«æŸ¥è©¢
   - ä½¿ç”¨åƒæ•¸åŒ–æŸ¥è©¢é˜²æ­¢ SQL æ³¨å…¥
   - å­—ä¸²ä¿®æ•´ (RTRIM) è™•ç†ç©ºç™½å­—å…ƒ

2. **éŒ¯èª¤è™•ç†**
   - å®Œæ•´çš„éŒ¯èª¤æ•ç²å’Œå ±å‘Š
   - æ‰¹æ¬¡è™•ç†æ™‚å–®å€‹å¤±æ•—ä¸å½±éŸ¿å…¶ä»–
   - è©³ç´°çš„éŒ¯èª¤æ—¥èªŒè¨˜éŒ„

3. **æ•ˆèƒ½å„ªåŒ–**
   - åˆ†æ‰¹æŸ¥è©¢è™•ç†å¤§é‡è³‡æ–™
   - ä¸¦è¡Œè™•ç†æå‡æ‰¹æ¬¡æ•ˆç‡
   - æ™ºèƒ½å¿«å–æ¸›å°‘é‡è¤‡æŸ¥è©¢

## å·¥ä½œæµç¨‹ç¯„ä¾‹

### å®Œæ•´çš„æ–‡æª”ç”Ÿæˆæµç¨‹

```bash
# 1. æ¸¬è©¦ç’°å¢ƒ
npm run dev test

# 2. æ¢ç´¢è³‡æ–™çµæ§‹
npm run explore operations
npm run explore operation ACPI02 --limit 5

# 3. ç”Ÿæˆå–®å€‹æ–‡æª”
npm run generate -- --operation ACPI02 --format all

# 4. æª¢æŸ¥ Excel æª”æ¡ˆ
npm run import-excel scan

# 5. åˆ†æå·®ç•°
npm run import-excel analyze ACPI02

# 6. åˆä½µæ–‡æª”
npm run import-excel merge ACPI02

# 7. æ‰¹æ¬¡è™•ç†æ‰€æœ‰æ“ä½œ
npm run analyze-merge-all -- -d  # é è¦½
npm run analyze-merge-all        # åŸ·è¡Œ
```

### å®šæœŸç¶­è­·æµç¨‹

```bash
# æ¯é€±äº”åŸ·è¡Œ
#!/bin/bash
DATE=$(date +%Y%m%d)
LOG_FILE="weekly-update-${DATE}.log"

# 1. å‚™ä»½ç¾æœ‰æ–‡æª”
cp -r ./output ./output.backup.${DATE}

# 2. åŸ·è¡Œæ‰¹æ¬¡åˆ†æ
npm run analyze-merge-all -- -d > ${LOG_FILE}

# 3. æª¢æŸ¥çµæœ
grep "éœ€äººå·¥å¯©æ ¸" ${LOG_FILE}

# 4. åŸ·è¡Œåˆä½µ
npm run analyze-merge-all

# 5. æäº¤è®Šæ›´
git add -A
git commit -m "Weekly documentation update ${DATE}"
```

## æ•…éšœæ’é™¤

### å¸¸è¦‹å•é¡Œ

#### 1. è³‡æ–™åº«é€£æ¥å¤±æ•—
```
éŒ¯èª¤ï¼šConnectionError: Failed to connect to server
```
**è§£æ±ºæ–¹æ¡ˆ**ï¼š
- æª¢æŸ¥ `.env` ä¸­çš„ `DB_SERVER` å’Œ `DB_PORT`
- ç¢ºèª SQL Server å…è¨±é ç«¯é€£æ¥
- æª¢æŸ¥é˜²ç«ç‰†è¨­å®š
- ç¢ºèªå¸³è™Ÿå¯†ç¢¼æ­£ç¢º

#### 2. OAPMB è¡¨ä¸å­˜åœ¨
```
éŒ¯èª¤ï¼šInvalid object name 'OAPMB'
```
**è§£æ±ºæ–¹æ¡ˆ**ï¼š
- ç¢ºèªè³‡æ–™åº«åç¨±æ­£ç¢º
- æª¢æŸ¥è¡¨åç¨±å¤§å°å¯«
- ç¢ºèªå¸³è™Ÿæœ‰è®€å–æ¬Šé™

#### 3. æ‰¹æ¬¡ç”Ÿæˆä¸­æ–·
```
éŒ¯èª¤ï¼šè…³æœ¬åªè™•ç†ç¬¬ä¸€å€‹æ“ä½œå°±çµæŸ
```
**è§£æ±ºæ–¹æ¡ˆ**ï¼š
- å·²åœ¨ v1.0.3 ä¿®å¾©
- æ›´æ–°åˆ°æœ€æ–°ç‰ˆæœ¬
- ä½¿ç”¨æ–°ç‰ˆè…³æœ¬ï¼ˆç§»é™¤äº† set -eï¼‰

#### 4. Excel æª”æ¡ˆæ‰¾ä¸åˆ°
```
éŒ¯èª¤ï¼šæ‰¾ä¸åˆ°å°æ‡‰çš„ Excel æª”æ¡ˆ
```
**è§£æ±ºæ–¹æ¡ˆ**ï¼š
- æª¢æŸ¥ `EXCEL_SOURCE_DIR` è¨­å®š
- ç¢ºèªæª”æ¡ˆå‘½åè¦å‰‡æ­£ç¢º
- åŸ·è¡Œ `npm run import-excel scan` æŸ¥çœ‹å¯ç”¨æª”æ¡ˆ

#### 5. è¨˜æ†¶é«”ä¸è¶³
```
éŒ¯èª¤ï¼šJavaScript heap out of memory
```
**è§£æ±ºæ–¹æ¡ˆ**ï¼š
```bash
# å¢åŠ  Node.js è¨˜æ†¶é«”é™åˆ¶
export NODE_OPTIONS="--max-old-space-size=4096"
npm run generate-all
```

### é™¤éŒ¯æŠ€å·§

1. **å•Ÿç”¨è©³ç´°è¼¸å‡º**
   ```bash
   npm run generate -- --operation ACPI02 --verbose
   ```

2. **æª¢æŸ¥ SQL æŸ¥è©¢**
   ```bash
   # åœ¨ .env ä¸­å•Ÿç”¨
   DEBUG_SQL=true
   ```

3. **æŸ¥çœ‹éŒ¯èª¤æ—¥èªŒ**
   ```bash
   # æ‰¹æ¬¡è™•ç†éŒ¯èª¤
   cat merge-reports/latest/errors/*.log
   ```

## ç‰ˆæœ¬æ­·å²

### v2.0.0 (2025-07-04)
- ğŸ†• æ–°å¢ Excel æ–‡æª”æ™ºèƒ½åˆä½µåŠŸèƒ½
- ğŸ†• æ–°å¢æ‰¹æ¬¡åˆ†æåˆä½µåŠŸèƒ½
- ğŸ†• æ–°å¢æ–¹æ³•ç‰¹å®šæ–‡æª”ç”Ÿæˆ
- ğŸ†• æ–°å¢æœªçŸ¥æ¬„ä½å€¼å°ç…§è¡¨
- ğŸ”§ å®Œå…¨é‡æ§‹ï¼Œè§£æ±º MCP ä¾è³´å•é¡Œ
- ğŸ”§ æ”¹ç”¨æ¨™æº– mssql å¥—ä»¶
- ğŸ“Š æ”¯æ´ 101 å€‹æ“ä½œä»£ç¢¼

### v1.0.3 (2025-07-04)
- ğŸ› ä¿®å¾©æ‰¹æ¬¡ç”Ÿæˆè…³æœ¬ä¸­æ–·å•é¡Œ
- ğŸ”§ ç§»é™¤ set -eï¼Œæ”¹é€²éŒ¯èª¤è™•ç†
- âš¡ å„ªåŒ–æ‰¹æ¬¡è™•ç†æ•ˆèƒ½

### v1.0.0 (2025-07-03)
- ğŸ‰ åˆå§‹ç‰ˆæœ¬ç™¼å¸ƒ
- âœ… åŸºæœ¬çš„æ¢ç´¢å’Œç”ŸæˆåŠŸèƒ½
- âœ… æ”¯æ´å¤šæ ¼å¼è¼¸å‡º

## è²¢ç»æŒ‡å—

### é–‹ç™¼ç’°å¢ƒè¨­ç½®

```bash
# å…‹éš†å°ˆæ¡ˆ
git clone https://github.com/hata1234/digiwin-oap-docs-generate.git
cd digiwin-oap-docs-generate

# å®‰è£ä¾è³´
npm install

# å»ºç«‹åˆ†æ”¯
git checkout -b feature/your-feature
```

### æäº¤è¦ç¯„

ä½¿ç”¨èªç¾©åŒ–æäº¤è¨Šæ¯ï¼š
- `feat:` æ–°åŠŸèƒ½
- `fix:` éŒ¯èª¤ä¿®å¾©
- `docs:` æ–‡æª”æ›´æ–°
- `refactor:` ç¨‹å¼ç¢¼é‡æ§‹
- `test:` æ¸¬è©¦ç›¸é—œ
- `chore:` ç¶­è­·æ€§å·¥ä½œ

### æ¸¬è©¦

```bash
# åŸ·è¡Œå–®å…ƒæ¸¬è©¦
npm test

# åŸ·è¡Œæ•´åˆæ¸¬è©¦
npm run test:integration

# æ¸¬è©¦è¦†è“‹ç‡
npm run test:coverage
```

### Pull Request æµç¨‹

1. Fork å°ˆæ¡ˆ
2. å»ºç«‹åŠŸèƒ½åˆ†æ”¯
3. æäº¤è®Šæ›´
4. æ¨é€åˆ°ä½ çš„ Fork
5. å»ºç«‹ Pull Request

## æˆæ¬Š

æœ¬å°ˆæ¡ˆæ¡ç”¨ ISC æˆæ¬Šæ¢æ¬¾ã€‚è©³è¦‹ [LICENSE](LICENSE) æª”æ¡ˆã€‚

## æ”¯æ´

å¦‚é‡åˆ°å•é¡Œï¼Œè«‹ï¼š
1. æŸ¥çœ‹[æ•…éšœæ’é™¤](#æ•…éšœæ’é™¤)ç« ç¯€
2. æœå°‹ç¾æœ‰çš„ [Issues](https://github.com/hata1234/digiwin-oap-docs-generate/issues)
3. å»ºç«‹æ–°çš„ Issueï¼Œæä¾›ï¼š
   - éŒ¯èª¤è¨Šæ¯
   - é‡ç¾æ­¥é©Ÿ
   - ç’°å¢ƒè³‡è¨Šï¼ˆNode.js ç‰ˆæœ¬ã€OS ç­‰ï¼‰

---

ğŸš€ **ERP æ–‡æª”è‡ªå‹•ç”Ÿæˆå·¥å…·** - è®“æ–‡æª”ç¶­è­·è®Šå¾—ç°¡å–®é«˜æ•ˆï¼